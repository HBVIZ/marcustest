import{gsap as a}from"https://esm.sh/gsap@3.12.2";import*as r from"https://esm.sh/three@0.157.0";import{GLTFLoader as q}from"https://esm.sh/three@0.157.0/examples/jsm/loaders/GLTFLoader.js";import{OrbitControls as V}from"https://esm.sh/three@0.157.0/examples/jsm/controls/OrbitControls.js";import{EffectComposer as X}from"https://esm.sh/three@0.157.0/examples/jsm/postprocessing/EffectComposer.js";import{RenderPass as Z}from"https://esm.sh/three@0.157.0/examples/jsm/postprocessing/RenderPass.js";import{UnrealBloomPass as $}from"https://esm.sh/three@0.157.0/examples/jsm/postprocessing/UnrealBloomPass.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function i(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(t){if(t.ep)return;t.ep=!0;const o=i(t);fetch(t.href,o)}})();function y(e,n,i,s,t="x",o=1,c=.5,N=.5,F=.5){const Y=n.isActive(),G=n.paused();["x","y","z"].includes(t)||(console.warn(`Invalid axis "${t}" passed to toggleSpin. Defaulting to 'x'.`),t="x"),o=Math.sign(o)||1;const W=e.rotation[t];Y||!G?(n.clear().to(e.rotation,{[t]:W+o*Math.PI/2,duration:N,ease:"power1.out",onComplete:()=>{n.pause(),i("idle",s)}}).play(),i("decelerating",s)):(n.clear().to(e.rotation,{[t]:W+o*Math.PI,duration:c,ease:"power1.in"}).to(e.rotation,{[t]:`+=${o*Math.PI*2}`,duration:F,ease:"linear",repeat:-1}).play(),i("spinning",s))}function K(e,n){const i=new r.DirectionalLight(16777215,2);i.position.set(5,10,10),i.castShadow=!0,e.add(i);const s=new r.DirectionalLight(16777215,.5);s.position.set(-5,2,5),e.add(s);const t=new r.DirectionalLight(16777215,1);t.position.set(0,5,-10),e.add(t);const o=new r.AmbientLight(4473924,.2);e.add(o);const c=new r.DirectionalLight(16777215,2);return c.position.set(0,-5,0),c.target.position.set(0,0,0),e.add(c),e.add(c.target),n.shadowMap.enabled=!0,{key:i,fill:s,rim:t,ambient:o,upLight:c}}const O=new r.Scene,l=new r.PerspectiveCamera(50,innerWidth/innerHeight,.01,1e3),d=new r.WebGLRenderer({antialias:!1});d.setPixelRatio(window.devicePixelRatio);d.setSize(innerWidth,innerHeight);const J=new q,p=a.timeline({}),v=a.timeline({}),Q=new Z(O,l),I=new X(d);I.addPass(Q);const ee=new $(new r.Vector2(window.innerWidth,window.innerHeight),.5,1.4,.5);I.addPass(ee);let te=new Map;var L,T,C,B,R,P,S,z,E=!0,A=!0;const ne=document.getElementById("wetRollerButton"),ie=a.timeline({paused:!0,repeat:-1,ease:"power1.inOut"}),oe=document.getElementById("brushBarButton"),re=a.timeline({paused:!0,repeat:-1,ease:"power1.inOut"}),ae=document.getElementById("sideCleanerButton"),se=a.timeline({paused:!0,repeat:-1,ease:"power1.inOut"}),le=a.timeline({paused:!0,repeat:-1,ease:"power1.inOut"}),ce=document.getElementById("wheelsButton"),ue=a.timeline({paused:!0,repeat:-1,ease:"power1.inOut"}),de=a.timeline({paused:!0,repeat:-1,ease:"power1.inOut"});O.background=new r.Color(1118481);d.setSize(innerWidth,innerHeight);d.setPixelRatio(devicePixelRatio);d.domElement.id="myCanvas";document.body.appendChild(d.domElement);window.addEventListener("resize",()=>{const e=window.innerWidth,n=window.innerHeight;l.aspect=e/n,l.updateProjectionMatrix(),d.setSize(e,n),d.setPixelRatio(window.devicePixelRatio)});var u=new V(l,d.domElement);u.minDistance=.5;u.maxDistance=1;l.position.z=1.5;l.position.x=0;l.position.y=5;d.toneMapping=r.ACESFilmicToneMapping;d.toneMappingExposure=1.22;d.shadowMap.enabled=!0;d.outputColorSpace=r.SRGBColorSpace;let _=document.createElement("video");_.src="./glb/cordfree/LCD_battery.mp4";_.loop=!0;let h=new r.VideoTexture(_);h.format=r.RGBFormat;h.minFilter=r.NearestFilter;h.maxFilter=r.NearestFilter;h.generateMipmaps=!1;var pe=new r.PlaneGeometry(.0271,.0271),me=new r.MeshBasicMaterial({map:h}),b=new r.Mesh(pe,me);b.rotateX(0-Math.PI*.5);b.rotateZ(0-Math.PI*1);b.translateZ(.141);b.translateY(.146);const g=K(O,d);g.key.intensity=0;g.fill.intensity=0;g.rim.intensity=0;g.ambient.intensity=0;J.load("./glb/robot/804_A_test_001.glb",e=>{let n=1;e.scene.scale.x=n,e.scene.scale.y=n,e.scene.scale.z=n,O.add(e.scene),L=e.scene.getObjectByName(m("rotor brush null A")),T=e.scene.getObjectByName(m("rotor brush null B")),C=e.scene.getObjectByName(m("SB-430273_AA - WET ROLLER ASSY_43089")),B=e.scene.getObjectByName(m("SB-430272_AA - DUST BOX ASSY")),R=e.scene.getObjectByName(m("SB-430287_AA - TRACTION WHEEL ASSY_30408")),P=e.scene.getObjectByName(m("SB-430287_AA - TRACTION WHEEL ASSY_38412")),S=e.scene.getObjectByName(m("SB-430273_AA - WET ROLLER ASSY_37478")),z=e.scene.getObjectByName(m("SB-430275_AA - BRUSHBAR ASSY_22072")),e.scene.getObjectByName(m("SB-430279_AA - FRONT WHEEL ASSY_5505")),e.scene.getObjectByName(m("SB-430287_AA - TRACTION WHEEL ASSY_41617")),fe()});j();function j(){requestAnimationFrame(j),I.render()}function w(e,n=16777215){e.traverse(i=>{if(i.isMesh){i.material=i.material.clone(),i.material.emissive=new r.Color(i.material.color),i.material.emissiveIntensity=0;const s=a.fromTo(i.material,{emissiveIntensity:5,duration:.8,ease:"sine.inOut"},{emissiveIntensity:0,duration:.8,ease:"sine.inOut"});te.set(i,s)}})}function fe(){a.to(g.key,{intensity:2,duration:1}),a.to(g.fill,{intensity:.5,duration:1,delay:.2}),a.to(g.rim,{intensity:1,duration:1,delay:.4}),a.to(g.ambient,{intensity:.2,duration:1,delay:.6});const e=a.timeline();p.to(l.position,{id:"openingAnimation",duration:3,x:0,y:-1.5,z:1.75,ease:"power2.inOut",onUpdate:function(){u.update()}}),e.call(()=>{U()},null,2.25),e.call(()=>{k()},null,1.75),e.call(()=>{D()},null,2),e.call(()=>{H()},null,2.25)}function m(e){return e.replace(/ /g,"_")}addEventListener("mousemove",e=>{e.clientX/innerWidth*2-1,-(e.clientY/innerHeight)*2+1});function x(){if(l.position.y>.1){const e=ge(l);e.tweening?(console.log("Camera is tweening to:",e.target),e.target&&e.target.x===0&&e.target.y===-1.5&&e.target.z===1.75?console.log("Camera is tweening to starting position"):(p.clear(),p.to(l.position,{duration:1.5,x:0,y:-1.5,z:1.75,overwrite:"true",ease:"power1.inOut",onUpdate:function(){u.update()}}))):(console.log("Camera is idle."),p.clear(),p.to(l.position,{duration:1.5,x:0,y:-1.5,z:1.75,overwrite:"true",ease:"power1.inOut",onUpdate:function(){u.update()}}))}M()}function ge(e){var i,s,t;const n=a.getTweensOf(e.position);for(const o of n)if(o.isActive()){const c=o.vars;return{tweening:!0,target:{x:(i=c.x)!=null?i:e.position.x,y:(s=c.y)!=null?s:e.position.y,z:(t=c.z)!=null?t:e.position.z}}}return{tweening:!1,target:null}}var we=document.getElementById("btn2");we.addEventListener("click",ve);var ye=document.getElementById("btn5");ye.addEventListener("click",he);ae.addEventListener("click",e=>{U(e)});function U(e){e instanceof Event&&(w(L,16711680),w(T)),y(L,se,f,"sideCleanerButton","y"),y(T,le,f,"sideCleanerButton","y",-1),x()}oe.addEventListener("click",e=>{H(e)});function H(e){e instanceof Event&&w(z),y(z,re,f,"brushBarButton","x"),x()}ne.addEventListener("click",e=>{k(e)});function k(e){e instanceof Event&&w(C),y(C,ie,f,"wetRollerButton","x",-1,.75,.75,1.5),x()}ce.addEventListener("click",e=>{D(e)});function D(e){e instanceof Event&&(w(R),w(P)),y(R,ue,f,"wheelsButton","x",1,1,1,3),y(P,de,f,"wheelsButton","x",1,1,1,3),x()}function ve(e){p.clear(),v.clear(),w(B),E==!0?(a.to(B.position,{duration:1.4,z:-300,ease:"power1.inOut",delay:.5}),p.to(l.position,{overwrite:"true",duration:1.5,x:-3,y:3,z:1,ease:"power1.inOut",onUpdate:function(){u.update()}}),v.to(u.target,{overwrite:"true",duration:1.5,x:0,y:.2,z:0,ease:"power1.inOut",onUpdate:function(){u.update()}}),E=!1,f("spinning",e.currentTarget.id)):(a.to(B.position,{duration:1.75,z:0,ease:"power1.inOut"}),p.to(l.position,{overwrite:"true",duration:1.75,x:-6,y:3,z:1,ease:"power1.inOut",delay:0,onUpdate:function(){u.update()}}),M(),E=!0,f("idle",e.currentTarget.id))}function he(e){w(S),p.clear(),v.clear(),A==!0?(a.to(S.position,{duration:1.4,x:400,ease:"power1.inOut"}),p.to(l.position,{overwrite:"true",duration:1.5,x:-.4,y:4,z:1.4,ease:"power1.inOut",onUpdate:function(){u.update()}}),v.to(u.target,{overwrite:"true",duration:1.5,x:-.4,y:-.25,z:-.1,ease:"power1.inOut",onUpdate:function(){u.update()}}),A=!1,f("spinning",e.currentTarget.id)):(a.to(S.position,{duration:1.2,x:0,ease:"power1.inOut"}),p.to(l.position,{overwrite:"true",duration:1.2,x:-6,y:3,z:1,ease:"power1.inOut",onUpdate:function(){u.update()}}),M(),A=!0,f("idle",e.currentTarget.id))}function M(e=1.5){v.clear(),v.to(u.target,{overwrite:"true",duration:e,x:0,y:0,z:0,ease:"power1.inOut",delay:0,onUpdate:function(){u.update()}})}function f(e,n){const s=document.getElementById(n).querySelector(".circle");s.classList.remove("idle","spinning","decelerating"),s.classList.add(e)}
